@if (this.gameState.article(); as art) {
  <h1 class="display-1 mt-4 font-serif">{{ art.title }}</h1>

  <div class="spacing-tight">
    @for (segment of art.segments; track segment) {
      @switch (true) {
        @case (segment.type === 'header2') {
          <h2 class="display-2 mt-4 mb-2 font-serif spacing-headers">
            @for (word of segment.body; track word) {
              @if (word.word) {
                <span class="word">
                @for (q of word.word; track q) {
                  {{ q.value }}
                }
                </span>
              }
              @if (word.math) {
                <span class="word display-5 spacing-normal">
                 <app-math [latex]="word.math.latex" [inline]="true"></app-math>
                </span>
              }
            }
          </h2>
        }
        @case (segment.type === 'header3') {
          <h3 class="display-3 mt-4 mb-2 font-serif spacing-headers">
            @for (word of segment.body; track word) {
              @if (word.word) {
                <span class="word">
                @for (q of word.word; track q) {
                  {{ q.value }}
                }
                </span>
              }
              @if (word.math) {
                <span class="word display-6 spacing-normal">
                 <app-math [latex]="word.math.latex" [inline]="true"></app-math>
                </span>
              }
            }
          </h3>
        }
        @case (segment.type === 'header4') {
          <h4 class="display-4 mt-4 mb-2 font-serif spacing-headers">
            @for (word of segment.body; track word) {
              @if (word.word) {
                <span class="word">
                @for (q of word.word; track q) {
                  {{ q.value }}
                }
                </span>
              }
              @if (word.math) {
                <span class="word fs-1 spacing-normal">
                 <app-math [latex]="word.math.latex" [inline]="true"></app-math>
                </span>
              }
            }
          </h4>
        }
        @case (segment.type === 'text') {
          <p class="display-6 mb-3 font-serif">
            @for (word of segment.body; track word) {
              @if (word.word) {
                <span class="word">
                @for (q of word.word; track q) {
                  {{ q.value }}
                }
                </span>
              }
              @if (word.math; as math) {
              @defer (on viewport) {
                  @if (math.noSpace) {
                    <span class="text-success word-no-space fs-2 spacing-normal">
                      <app-math [latex]="word.math.latex" [inline]="true"></app-math>
                    </span>
                  } @else {
                    <span class="text-success word fs-2 spacing-normal">
                      <app-math [latex]="word.math.latex" [inline]="true"></app-math>
                    </span>
                  }
                } @placeholder {
                  <span class="word fs-2 spacing-normal">
                    <p class="display-6 placeholder-glow placeholder col-{{getRandomInt(1,3)}}"></p>
                  </span>
                }
              }
            }
          </p>
        }
        @case (segment.type === 'math') {
          @defer (on viewport) {
          <div class="fs-2 text-success spacing-normal text-center math-block">
            <app-math [latex]="segment.body[0].math?.latex" [inline]="false"></app-math>
          </div>
          } @placeholder {
            <div class="fs-2 spacing-normal text-center math-block">
              <p class="placeholder-glow placeholder col-{{getRandomInt(1, 7)}}"></p>
            </div>
          }
        }
      }
    }
  </div>
} @else {
  <p class="font-serif fs-5">Loading article...</p>
}
